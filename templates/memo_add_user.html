{% extends 'base.html' %}

{% block title %}➕ إضافة مستخدم جديد - ميمو{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-green-50 via-white to-green-100 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 py-10 px-4">

  <!-- ✅ الكارد -->
  <div class="w-full max-w-3xl bg-white/80 dark:bg-gray-800/80 backdrop-blur-xl rounded-3xl shadow-2xl border border-gray-200 dark:border-gray-700 animateanimated animatefadeInUp">
    <div class="p-10">

      <!-- ✨ الهيدر -->
      <div class="text-center mb-8">
        <div class="mx-auto w-16 h-16 flex items-center justify-center rounded-full bg-gradient-to-br from-green-400 to-green-600 text-white shadow-lg mb-4">
          <i class="bi bi-person-plus fs-3"></i>
        </div>
        <h3 class="text-3xl font-extrabold text-gray-800 dark:text-gray-100">➕ إضافة مستخدم جديد</h3>
        <p class="text-gray-500 dark:text-gray-400 mt-2">املأ البيانات التالية لإنشاء حساب جديد</p>
      </div>

      <!-- ✅ إشعارات -->
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="mb-6 space-y-2">
            {% for category, message in messages %}
              <div class="alert alert-{{ category }} rounded-2 shadow-sm px-3 py-2">
                {{ message }}
              </div>
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}

      <!-- 📝 النموذج -->
      <form method="POST" action="{{ url_for('add_user') }}" id="addUserForm" novalidate class="grid grid-cols-1 md:grid-cols-2 gap-6">

        <!-- اسم المستخدم -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1">اسم المستخدم</label>
          <div class="relative">
            <span class="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400">
              <i class="bi bi-person"></i>
            </span>
            <input type="text" name="username" class="w-full pl-10 pr-4 py-2 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-900 shadow-sm focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="اكتب اسم المستخدم" required>
          </div>
          <div class="invalid-feedback text-red-500 text-sm mt-1">اسم المستخدم مطلوب</div>
        </div>

        <!-- البريد الإلكتروني -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1">البريد الإلكتروني</label>
          <div class="relative">
            <span class="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400">
              <i class="bi bi-envelope"></i>
            </span>
            <input type="email" name="email" class="w-full pl-10 pr-4 py-2 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-900 shadow-sm focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="example@mail.com" required>
          </div>
          <div class="invalid-feedback text-red-500 text-sm mt-1">الرجاء إدخال بريد صحيح</div>
        </div>

        <!-- الاسم الأول -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1">الاسم الأول</label>
          <div class="relative">
            <span class="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400">
              <i class="bi bi-person-badge"></i>
            </span>
            <input type="text" name="first_name" class="w-full pl-10 pr-4 py-2 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-900 shadow-sm focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="محمد">
          </div>
        </div>

        <!-- الاسم الأخير -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1">الاسم الأخير</label>
          <div class="relative">
            <span class="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400">
              <i class="bi bi-person-badge-fill"></i>
            </span>
            <input type="text" name="last_name" class="w-full pl-10 pr-4 py-2 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-900 shadow-sm focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="أحمد">
          </div>
        </div>

        <!-- كلمة المرور -->
        <div class="md:col-span-2">
          <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1">كلمة المرور</label>
          <div class="relative">
            <span class="absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400">
              <i class="bi bi-lock"></i>
            </span>
            <input type="password" name="password" minlength="6" class="w-full pl-10 pr-4 py-2 rounded-xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-900 shadow-sm focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="**" required>
          </div>
          <div class="invalid-feedback text-red-500 text-sm mt-1">كلمة المرور يجب أن تكون 6 أحرف على الأقل</div>
        </div>

        <!-- ✅ الأزرار -->
        <div class="md:col-span-2 text-center mt-6">
          <button type="submit" class="px-8 py-3 rounded-2xl bg-gradient-to-r from-green-500 to-green-600 text-white font-bold shadow-lg hover:opacity-90 transition-all duration-200 transform hover:scale-105">
            ✅ إضافة
          </button>
          <a href="{{ url_for('memo_users') }}" class="ml-3 px-6 py-3 rounded-2xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-900 text-gray-600 dark:text-gray-300 font-semibold hover:bg-gray-100 dark:hover:bg-gray-700 shadow transition-all duration-200">
            ⬅️ عودة
          </a>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- ✅ JS للتحقق -->
<script>
  (function () {
    'use strict'
    const form = document.getElementById('addUserForm')
    form.addEventListener('submit', function (event) {
      if (!form.checkValidity()) {
        event.preventDefault()
        event.stopPropagation()
      }
      form.classList.add('was-validated')
    }, false)
  })()
</script>
{% endblock %}