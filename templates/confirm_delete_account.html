{% extends "base.html" %}
{% block title %}🗑️ حذف الحساب - ميمو{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-red-50 via-white to-red-100 dark:from-gray-950 dark:via-gray-900 dark:to-black px-4 py-12">
  <div class="w-full max-w-md animate-fade-in-up">
    <div class="bg-white dark:bg-gray-900 p-10 rounded-3xl shadow-2xl border border-red-100 dark:border-red-800 relative overflow-hidden">

      <!-- خلفية زخرفية -->
      <div class="absolute -top-16 -right-16 w-40 h-40 bg-red-500/10 rounded-full blur-3xl"></div>
      <div class="absolute -bottom-20 -left-16 w-48 h-48 bg-red-400/10 rounded-full blur-3xl"></div>

      <!-- العنوان -->
      <div class="text-center mb-8 relative">
        <div class="mx-auto w-20 h-20 flex items-center justify-center rounded-2xl bg-gradient-to-br from-red-100 to-red-200 dark:from-red-900 dark:to-red-800 text-red-600 dark:text-red-300 shadow-lg mb-4">
          🗑️
        </div>
        <h3 class="text-2xl font-black text-red-600 dark:text-red-400 tracking-wide">تأكيد حذف الحساب</h3>
        <p class="text-sm text-gray-500 dark:text-gray-400 mt-2">⚠️ عملية الحذف نهائية ولا يمكن التراجع عنها.</p>
      </div>

      <!-- الرسائل -->
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="space-y-3 mb-6">
            {% for category, message in messages %}
              <div class="px-4 py-3 rounded-xl 
                          {% if category == 'danger' %}
                            bg-red-100 text-red-700 border border-red-200 shake
                          {% else %}
                            bg-green-100 text-green-700 border border-green-200
                          {% endif %}
                          shadow-sm text-sm font-medium">
                {{ message }}
              </div>
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}

      <!-- النموذج -->
      <form id="deleteForm" action="{{ url_for('delete_account') }}" method="POST" class="space-y-6">
        <div>
          <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">🔑 كلمة المرور</label>
          <input type="password" 
                 name="password" 
                 placeholder="••••••••" 
                 required
                 class="w-full px-4 py-3 rounded-xl border border-gray-300 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-400 focus:ring-2 focus:ring-red-500 focus:border-red-500 transition shadow-sm">
        </div>

        <!-- الأزرار -->
        <div class="flex items-center justify-between gap-4 pt-4">
          <a href="{{ url_for('settings') }}"
             class="flex-1 text-center px-5 py-3 rounded-xl font-semibold bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 transition shadow-sm">
            إلغاء
          </a>
          <!-- زر الحذف يفتح المودال -->
          <button type="button"
                  onclick="openModal()"
                  class="flex-1 px-5 py-3 rounded-xl font-bold bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white shadow-lg transition transform hover:-translate-y-0.5 hover:shadow-xl">
            🚨 حذف نهائي
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- ✅ المودال -->
<div id="confirmModal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
  <div class="bg-white dark:bg-gray-900 p-8 rounded-2xl shadow-2xl max-w-md w-full animate-fade-in-up">
    <h2 class="text-xl font-bold text-red-600 dark:text-red-400 mb-4 text-center">هل أنت متأكد؟</h2>
    <p class="text-sm text-gray-600 dark:text-gray-400 text-center mb-6">⚠️ سيتم حذف حسابك وجميع بياناتك نهائيًا ولا يمكن التراجع عن هذه الخطوة.</p>

    <div class="flex gap-4">
      <button onclick="closeModal()" 
              class="flex-1 px-5 py-3 rounded-xl font-semibold bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-700 transition shadow-sm">
        إلغاء
      </button>
      <button onclick="document.getElementById('deleteForm').submit()" 
              class="flex-1 px-5 py-3 rounded-xl font-bold bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white shadow-lg transition transform hover:-translate-y-0.5 hover:shadow-xl">
        ✅ نعم، احذف
      </button>
    </div>
  </div>
</div>

<!-- 🎨 أنيميشن Tailwind مخصص -->
<style>
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}
.animate-fade-in-up {
  animation: fadeInUp 0.7s ease-out forwards;
}
@keyframes shakeAnim {
  0%, 100% { transform: translateX(0); }
  20%, 60% { transform: translateX(-6px); }
  40%, 80% { transform: translateX(6px); }
}
.shake {
  animation: shakeAnim 0.5s ease-in-out;
}
</style>

<!-- 🚀 سكريبت بسيط للتحكم بالمودال -->
<script>
function openModal() {
  document.getElementById('confirmModal').classList.remove('hidden');
}
function closeModal() {
  document.getElementById('confirmModal').classList.add('hidden');
}
</script>
{% endblock %}